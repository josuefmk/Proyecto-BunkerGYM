{% extends 'core/home.html' %}
{% load humanize %}

{% block content %}

<div class="stock-wrapper">

    <div class="card-premium-v2 stock-card">

        <h2 class="titulo-form">ðŸ“¦ Agregar o Quitar Stock</h2>
        <p class="sub-text">Seleccione el producto y actualice su inventario</p>

        {% if messages %}
        <div id="mi-mensaje-contenedor" class="mi-mensaje-contenedor">
            {% for message in messages %}
                <div class="mi-mensaje mi-mensaje-{{ message.tags }}">{{ message }}</div>
            {% endfor %}
        </div>
        <script>
            setTimeout(() => {
                const msg = document.getElementById("mi-mensaje-contenedor");
                if (msg) {
                    msg.style.opacity = 0;
                    setTimeout(() => msg.remove(), 500);
                }
            }, 5000);
        </script>
        {% endif %}

        <div class="tabla-premium-wrapper">
            <table class="tabla-premium">
                <thead>
                    <tr>
                        <th>Producto</th>
                        <th>Stock Actual</th>
                        <th>Cantidad</th>
                        <th>AcciÃ³n</th>
                        <th>Actualizar</th>
                    </tr>
                </thead>

                <tbody>
                    {% for producto in productos %}
                    <tr>
                        <td>{{ producto.nombre }}</td>
                        <td>{{ producto.stock }}</td>

                        <td>
                            <form method="POST" action="{% url 'agregar_stock' %}" class="form-inline-stock">
                                {% csrf_token %}
                                <input type="hidden" name="producto_id" value="{{ producto.id }}">
                                <input type="number" min="1" name="cantidad" required class="input-premium" style="width: 90px;">
                        </td>

                        <td>
                            <select name="accion" class="select-premium" style="width: 120px;">
                                <option value="sumar">âž• Agregar</option>
                                <option value="restar">âž– Quitar</option>
                            </select>
                        </td>

                        <td>
                            <button type="submit" class="btn-premium-full small">Actualizar</button>
                            </form>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="5" class="mensaje-centrado">No hay productos registrados.</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
 <br>
 
        <a href="{% url 'productos' %}"  class="btn-premium-secundario">âŸµ Volver</a>
    </div>

</div>

{% endblock %}
